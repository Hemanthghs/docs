# Code Structure

Here to briefly introduce the structure of `@cosmonauts/cosmos-*` packages, which is designed around the core functionality of `sign` and `broadcast` .

## Packages

| Package                            | Meant For                                   |
| :--------------------------------- | :------------------------------------------ |
| **@cosmonauts/cosmos-proto**             | proto/direct signing                        |
| **@cosmonauts/cosmos-amino**             | amino signing                               |
| **@cosmonauts/cosmos-cosmjs**            | signing with cosmjs signingClient interface |
| **@cosmonauts/cosmos-stargate**          | stargate signing                            |
| **@cosmonauts/cosmos-cosmwasm-stargate** | cosmwasm and stargate signing               |

> Dependency Order (`a -> b` means _b_ is dependent on _a_):
>
> `@cosmonauts/core` -> `@cosmonauts/cosmos-proto` -> `@cosmonauts/cosmos-amino` -> `@cosmonauts/cosmos-cosmjs` -> `@cosmonauts/cosmos-stargate` -> `@cosmonauts/cosmos-cosmwasm-stargate`

> Registered messages types and `TelescopeGeneratedType` constants also be exported by `@cosmonauts/cosmos-stargate` and `@cosmonauts/cosmos-cosmwasm-stargate` to facilitate code developing.

## Signer Classes

There’re several types of signer class, and they’re

| Class                    | Package                          | Description                                                                                                                                                                                                                                                     |
| :----------------------- | :------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **BaseSigner**           | _@cosmonauts/core_                     | defines common methods independent of network i.e. _cosmos_ or _eth_                                                                                                                                                                                            |
| **Signer**               | _@cosmonauts/cosmos-proto_             | implements _proto/direct_ signing process                                                                                                                                                                                                                       |
| **AminoSigner**          | _@cosmonauts/cosmos-amino_             | extends Signer above and implements _amino_ signing process                                                                                                                                                                                                     |
| **CosmjsSigner**         | _@cosmonauts/cosmos-cosmjs_            | is meant for swift migration from _cosmjs_. It provides methods that are basically the same with _signingStargateClient_ and _stargateClient_ in _@cosmjs/stargate_. Note some returned _number_ are changed to _bigint_ in _CosmjsSigner_ compared to _cosmjs_ |
| **StargateSigner**       | _@cosmonauts/cosmos-stargate_          | is **Signer** that with _stargate_ message types being registered by default                                                                                                                                                                                    |
| **StargateAminoSigner**  | _@cosmonauts/cosmos-stargate_          | is **AminoSigner** that with _stargate_ message types being registered by default                                                                                                                                                                               |
| **StargateCosmjsSigner** | _@cosmonauts/cosmos-stargate_          | is **CosmjsSigner** that with _stargate_ message types being registered by default                                                                                                                                                                              |
| **CosmWasmSigner**       | _@cosmonauts/cosmos-cosmwasm-stargate_ | is **Signer** that with _stargate_ and _cosmwasm_ message types being registered by default                                                                                                                                                                     |
| **CosmWasmAminoSigner**  | _@cosmonauts/cosmos-cosmwasm-stargate_ | is **AminoSigner** that with _stargate_ and _cosmwasm_ message types being registered by default                                                                                                                                                                |
| **CosmWasmCosmjsSigner** | _@cosmonauts/cosmos-cosmwasm-stargate_ | is **CosmjsSigner** that with _stargate_ and _cosmwasm_ message types being registered by default                                                                                                                                                               |

> See more information of _stargate_ and _cosmwasm_ messages types: [Registered Messages](/cosmos/messages)

## Structure Tree

```sh
├── `@cosmonauts/core`
│   ├── class `BaseSigner`
│   │   ├── method `signBytes` (sign `Uint8Array`)
│   │   ├── method `verifyBytes` (verify `Uint8Array`)
│   │
├── `@cosmonauts/cosmos-proto`
│   ├── class `Signer` extends `BaseSigner`
│   │   ├── method (query) `getChainId`
│   │   ├── method (query) `getSequence`
│   │   ├── method `signDoc` (sign `SignDoc` with DIRECT signing)
│   │   ├── method `signMessages` (sign messages of type `EncodeObject[]` with DIRECT signing)
│   │   ├── method `broadcast` (broadcast `TxRaw`)
│   │   ├── method `broadcastBytes` (broadcast `Uint8Array`)
│   │   ├── method `estimateGas`
│   │   └── method `estimateFee`
│   │
├── `@cosmonauts/cosmos-amino`
│   ├── class `AminoSigner` extends `Signer`
│   │   ├── method `signDocWithAmino` (sign `StdDoc` with AMINO signing)
│   │   └── method `signMessagesWithAmino` (sign messages of type `EncodeObject[]` with AMINO signing)
│   │
├── `@cosmonauts/cosmos-cosmjs`
│   ├── class `CosmjsSigner` (with `AminoSigner` used inside)
│   │   │
│   │   ├── \* Shared methods with `SigningStargateClient` and `SigningCosmWasmClient` *\
│   │   ├── method (static) `connectWithSigner`
│   │   ├── method `simulate` (return `bigint` rather than `number`)
│   │   ├── method `sign`
│   │   ├── method `signAndBroadcast`
│   │   ├── method `signAndBroadcastSync`
│   │   │
│   │   ├── \* Shared methods with `StargateClient` and `CosmWasmClient` *\
│   │   ├── method (query) `getChainId`
│   │   ├── method (query) `getSequence`
│   │   ├── method (query) `getTx`
│   │   ├── method `broadcastTx`
│   │   └── method `broadcastTxSync`
│   │
├── `@cosmonauts/cosmos-stargate`
│   ├── class `StargateSigner` extends `Signer`
│   ├── class `StargateAminoSigner` extends `AminoSigner`
│   ├── class `StargateCosmjsSigner` extends `CosmjsSigner`
│   │
├── `@cosmonauts/cosmos-cosmwasm-stargate`
│   ├── class `CosmWasmSigner` extends `StargateSigner`
│   ├── class `CosmWasmAminoSigner` extends `StargateAminoSigner`
│   └── class `CosmWasmCosmjsSigner` extends `StargateCosmjsSigner`
```

## Helper Methods

There are helper methods generated by `Telescope` and extended by `StargateCosmjsSigner` and `CosmWasmCosmjsSigner`.

### Stargate

Below are helper methods supported by both `StargateCosmjsSigner` and `CosmWasmCosmjsSigner`.

Methods for signing and broadcasting messages.

```json
{
    "sendTokens": "cosmos.bank.v1beta1.send",
    "delegateTokens": "cosmos.staking.v1beta1.delegate",
    "undelegateTokens": "cosmos.staking.v1beta1.undelegate",
    "withdrawRewards": "cosmos.distribution.v1beta1.withdrawDelegatorReward",
    "sendIbcTokens": "ibc.applications.transfer.v1.transfer"
}
```

Methods for querying information.

```json
{
    "getBalance": "cosmos.bank.v1beta1.balance",
    "getAllBalances": "cosmos.bank.v1beta1.allBalances",
    "getBalanceStaked": "cosmos.staking.v1beta1.delegatorDelegations",
    "getDelegation": "cosmos.staking.v1beta1.delegation"
}
```

### CosmWasm

Below are helper methods only supported by `CosmWasmCosmjsSigner`.

Methods for signing and broadcasting messages.

```json
{
    "upload": "cosmwasm.wasm.v1.storeCode",
    "instantiate": "cosmwasm.wasm.v1.instantiateContract",
    "instantiate2": "cosmwasm.wasm.v1.instantiateContract2",
    "updateAdmin": "cosmwasm.wasm.v1.updateAdmin",
    "clearAdmin": "cosmwasm.wasm.v1.clearAdmin",
    "migrate": "cosmwasm.wasm.v1.migrateContract",
    "executeMultiple": "cosmwasm.wasm.v1.executeContract"
}
```

Methods for querying information.

```json
{
    "getCodes": "cosmwasm.wasm.v1.codes",
    "getCodeDetails": "cosmwasm.wasm.v1.code",
    "getContracts": "cosmwasm.wasm.v1.contractsByCode",
    "getContractsByCreator": "cosmwasm.wasm.v1.contractsByCreator",
    "getContract": "cosmwasm.wasm.v1.contractInfo",
    "getContractCodeHistory": "cosmwasm.wasm.v1.contractHistory",
    "queryContractRaw": "cosmwasm.wasm.v1.rawContractState",
    "queryContractSmart": "cosmwasm.wasm.v1.smartContractState"
}
```